I would recommend using parameters to the PowerShell script instead of having to deal with environment variables.
Also it is a good practice to close the Azure connection at the end of the scripts. Again, PS params may be better than environment variables there too.
